<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BĐS Tốt - Tiêu Đề Bài Viết</title>
    
   <link rel="icon" href="favicon.png" type="image/png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/menu.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/listing.css">
</head>
<body>

   
    <div id="menu-overlay" class="menu-overlay"></div>
    <header class="header-wrapper">
        <div class="header-footer-limiter">
            <div class="site-header">
                <button class="hamburger-button" id="hamburger-button" aria-label="Mở menu">
                    <span class="bar"></span><span class="bar"></span><span class="bar"></span>
                </button>
                <a href="index.html" class="logo-link"><img src="assets/images/logo.png" alt="Logo Chung Cư Tốt" class="logo"></a>
                <nav class="main-nav" id="main-nav">
                    <ul id="main-menu-list"></ul>
                </nav>
                <div class="header-actions">
                    <a href="favorites.html" class="header-favorite-btn" aria-label="Danh sách yêu thích">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>
                        <span class="favorite-counter">0</span>
                    </a>
                    <a href="#" class="search-button-new" aria-label="Tìm kiếm">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/></svg>
                    </a>
                </div>
            </div>
        </div>
    </header>
    <div id="cct-mega-menu">
    <div class="menu-panel-overlay"></div>
    <div class="menu-panel-columns">
        <div class="menu-panel-col col-1">
            <h4>Loại hình</h4>
            <ul id="mega-menu-col-1-list"></ul>
        </div>
        <div class="menu-panel-col col-2">
            <h4>Khu vực</h4>
            <ul id="mega-menu-col-2-list"></ul>
        </div>
        <div class="menu-panel-col col-3">
            <h4>Dự án nổi bật</h4>
            <div id="mega-menu-col-3-content"></div>
        </div>
    </div>
    </div>
    <div class="main-container">
        <div class="content-limiter">
            <div class="content-wrapper">
                <main class="main-column">
                    <div class="breadcrumb">
                    
                    </div>
                    
                    <article class="article-detail">
                        <h1>Bất động sản sôi động vào dịp tết Nguyên Đán, Vì sao lại như vậy?</h1>
                        
                        <div class="article-meta">
                            <span>Tác giả: <a href="tac-gia.html" class="author-link">Minh Anh</a></span>|
                            <span>Cập nhật: 23/06/2025</span>
                        </div>

                        <a href="javascript:void(0);" class="lightbox-trigger" data-src="assets/images/tintuc1.png">
                            <img src="assets/images/tintuc1.png" alt="Ảnh bài viết chi tiết" class="featured-image-detail">
                        </a>

                        <div class="article-content">
                            <p><strong>Đây là phần tóm tắt/mở đầu của bài viết (còn gọi là sapo). Đoạn này sẽ được in đậm để thu hút sự chú ý của người đọc ngay từ những giây đầu tiên.</strong></p>

                            <nav class="toc-container">
                                <p class="toc-title">Nội dung chính</p>
                                <ol class="toc-list">
                                    <li><a href="#muc-1">Tiêu đề phụ cấp 1</a></li>
                                    <li><a href="#muc-2">Tiêu đề phụ cấp 2</a></li>
                                </ol>
                            </nav>

                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
                            
                            <h2 id="muc-1">Tiêu đề phụ cấp 1 (thẻ h2)</h2>
                            <p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Curabitur pretium tincidunt lacus. Nulla gravida orci a odio. Nullam varius, turpis et commodo pharetra, est eros bibendum elit, nec luctus magna felis sollicitudin mauris. Integer in mauris eu nibh euismod gravida. Duis ac tellus et risus vulputate vehiculah.</p>
                            <blockquote>Đây là một đoạn trích dẫn quan trọng trong bài viết, dùng để nhấn mạnh một ý kiến hoặc một câu nói đáng chú ý.</blockquote>
                            <a href="#" class="open-nam-mua-nha-modal" style="text-decoration: underline; font-weight: bold;">
                                Xem năm mua/xây nhà hợp tuổi
                            </a> 
                            
                            
                            <h3 id="muc-2">Tiêu đề phụ cấp 2 (thẻ h3)</h3>
                            <p>Donec nec justo eget felis facilisis fermentum. Aliquam porttitor mauris sit amet orci. Aenean dignissim pellentesque felis. Morbi in sem quis dui placerat ornare. Pellentesque odio nisi, euismod in, pharetra a, ultricies in, diam. Sed arcu. Cras consequat.</p>
                            <a href="#" class="open-khai-toan-modal" style="text-decoration: underline; font-weight: bold;">
                                Khái toán xây dựng
                            </a>
                            <ul>
                                <li>Đây là một mục trong danh sách.</li>
                                <li>Phù hợp để liệt kê các ý chính.</li>
                                <li>Ví dụ: các đặc điểm của một dự án.</li>
                            </ul>
                        </div>
                    </article>
                    <div class="related-project-box">
                        <div class="related-project-header">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-lightbulb" viewBox="0 0 16 16">
                                <path d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13h-5a.5.5 0 0 1-.46-.302l-.761-1.77a1.964 1.964 0 0 0-.453-.618A5.984 5.984 0 0 1 2 6zm6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1z"/>
                                <path d="M7 14a1 1 0 0 1 1-1h.01a1 1 0 0 1 0 2H8a1 1 0 0 1-1-1z"/>
                            </svg>
                            <h4>Có thể bạn quan tâm</h4>
                        </div>
                        <div class="related-project-item">
                            <a href="#" class="related-project-image">
                                <img src="assets/images/duan1.jpg" alt="Dự án liên quan">
                            </a>
                            <div class="related-project-info">
                                <h5 class="project-name"><a href="#">Masteri Centre Point</a></h5>
                                <p class="project-address">Vinhomes Grand Park, TP. Thủ Đức, TP.HCM</p>
                                <p class="project-price">Từ 4 - 6 tỷ</p>
                            </div>
                            <a href="#" class="btn-primary btn-small">Xem chi tiết</a>
                        </div>
                    </div>
                    <div class="article-actions">
                        <div class="article-share">
                            <strong>Chia sẻ bài viết:</strong>
                            <a href="https://www.facebook.com/sharer/sharer.php?u=" class="social-share-btn facebook" target="_blank" rel="noopener noreferrer">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0 0 3.604 0 8.049c0 4.141 3.07 7.587 7.028 7.996V9.91H4.943V8.05h2.085V6.586c0-2.067 1.22-3.215 3.13-3.215.895 0 1.85.166 1.85.166v1.64h-.94c-1.01 0-1.35.62-1.35 1.28v1.54h1.83l-.28 1.86H9.08V16c3.956-.41 7.028-3.855 7.028-7.951z"/></svg>
                                <span>Facebook</span>
                            </a>
                            <button class="social-share-btn copy-link" id="copy-link-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path fill-rule="evenodd" d="M9.5 1h-3a1 1 0 0 0-1 1v1.5h5V2a1 1 0 0 0-1-1zM3 2.5a.5.5 0 0 1 .5-.5H6a.5.5 0 0 1 0 1H3.5a.5.5 0 0 1-.5-.5zm10.5 0a.5.5 0 0 1 .5-.5h2.5a.5.5 0 0 1 0 1H14a.5.5 0 0 1-.5-.5z"/></svg>
                                <span>Copy Link</span>
                            </button>
                        </div>
                    </div>

                    <section class="related-articles-section">
                        <h2 class="section-title">Bài viết liên quan</h2>
                        <div class="related-articles-grid">
                            <article class="related-article-card">
                                <a href="#" class="related-article-thumbnail">
                                    <img src="assets/images/tintuc2.png" alt="Ảnh bài viết liên quan">
                                </a>
                                <div class="related-article-content">
                                    <h4 class="related-article-title"><a href="#">Tạp chí ONCREATIVE Tết 2025: Toàn cảnh truyền thông sáng tạo</a></h4>
                                </div>
                            </article>
                            <article class="related-article-card">
                                <a href="#" class="related-article-thumbnail">
                                    <img src="assets/images/tintuc3.png" alt="Ảnh bài viết liên quan">
                                </a>
                                <div class="related-article-content">
                                    <h4 class="related-article-title"><a href="#">Chiến dịch marketing đón Tết đủ đầy với bộ 3 xu hướng truyền thông</a></h4>
                                </div>
                            </article>
                        </div>
                    </section>
                </main>

                <aside class="sidebar-column">
                    <div class="widget">
                        <h3 class="widget-title">Bài viết xem nhiều</h3>
                        <ul>
                            <li><a href="#">5 tiêu chí vàng khi chọn mua căn hộ</a></li>
                            <li><a href="#">Phân biệt sổ hồng và sổ đỏ chính xác nhất</a></li>
                            <li><a href="#">Top 5 dự án chung cư đáng sống nhất tại Hà Nội</a></li>
                            <li><a href="#">Có nên vay ngân hàng 70% để mua nhà?</a></li>
                        </ul>
                    </div>
                     <div class="widget">
                        <h3 class="widget-title">Quảng cáo</h3>
                        <a href="#">
                            <img src="assets/images/banner-quangcao.jpg" alt="Quảng cáo" style="border-radius: 8px;">
                        </a>
                    </div>
                </aside>
            </div>
        </div>
    </div>
    <div id="favorites-drawer-container">
        <div class="favorites-drawer-overlay"></div>
        <div class="favorites-drawer">
            <div class="drawer-header">
                <h3>Danh sách yêu thích</h3>
                <button class="drawer-close-btn" title="Đóng">&times;</button>
            </div>
            <div class="drawer-content">
                </div>
           
        </div>
    </div>
    <footer class="footer-wrapper">
        <div class="header-footer-limiter">
            <div class="site-footer">
                <div class="footer-widget footer-col-1">
                     <a href="index.html">
                        <img src="assets/images/logo-footer.png" alt="Logo Footer" class="footer-logo">
                    </a>
                    <p><b>BDSTot.net - Bất Động Sản Tốt</b></p>
               		<p>Số điện thoại: <a href="tel:0123456789">0123 456 789</a></p>
                    <p>Mail: <a href="mailto:contact@bdstot.net">contact@bdstot.net</a></p>
                    
                </div>

                <div class="footer-widget">
                    <h4 class="widget-title accordion-toggle">VỀ CHÚNG TÔI</h4>
                    <ul class="widget-links">
                        <li><a href="gioi-thieu.html">Giới thiệu</a></li>
                        <li><a href="doi-ngu.html">Đội ngũ</a></li>
                        <li><a href="lien-he.html">Liên hệ</a></li>
                    </ul>
                </div>

                <div class="footer-widget">
                    <h4 class="widget-title accordion-toggle">ĐIỀU KHOẢN</h4>
                    <ul class="widget-links">
                        <li><a href="chinh-sach-bao-mat.html">Chính sách bảo mật</a></li>
                        <li><a href="dieu-khoan-su-dung.html">Điều khoản sử dụng</a></li>
                    </ul>
                </div>

                <div class="footer-widget footer-col-4">
                    <h4 class="widget-title">KẾT NỐI VỚI CHÚNG TÔI</h4>

                    <div class="footer-socials">
                        <a href="#" class="social-icon" aria-label="Facebook">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                <path d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m13 2h-2.5a3.5 3.5 0 0 0-3.5 3.5V11h-2v3h2v7h3v-7h3v-3h-3V8.5A.5.5 0 0 1 15 8h3V5z"/>
                            </svg>
                        </a>
                        <a href="#" class="social-icon" aria-label="YouTube">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24">
                                <path d="M10 15l5.19-3L10 9v6m11.56-7.83c.13.47.22 1.1.28 1.9.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83-.25.9-.83 1.48-1.73 1.73-.47.13-1.33.22-2.65.28-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44-.9-.25-1.48-.83-1.73-1.73-.13-.47-.22-1.1-.28-1.9-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83.25-.9.83-1.48 1.73-1.73.47-.13 1.33.22 2.65.28 1.3.07 2.49.1 3.59.1L12 5c4.19 0 6.8.16 7.83.44.9.25 1.48.83 1.73 1.73z"/>
                            </svg>
                        </a>
                        <a href="#" class="social-icon" aria-label="LinkedIn">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24" fill="white">
                                <path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4s1.39.63 1.39 1.4v4.93h2.8zM6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69s-1.68.76-1.68 1.69c0 .92.75 1.68 1.68 1.68zm-1.39 1.3h2.79v8.37H5.5V9.86z"/>
                            </svg>
                        </a>
                    </div>

                    <a href="#" target="_blank" rel="noopener noreferrer" style="margin-top: 20px; display: inline-block;">
                        <img src="assets/images/bo-cong-thuong.png" alt="Logo Bộ Công Thương" class="bct-logo">
                    </a>
                </div>
            </div>
             <div class="copyright-text">
                <p>Copyright 2025 - Bản quyền của BĐS Tốt</p>
            </div>
        </div>
    </footer>
 <div id="lightbox" class="lightbox-container">
        <div class="lightbox-controls">
            
            <button id="lightbox-close" title="Đóng" class="lightbox-control-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                  <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                </svg>
            </button>
        </div>
        <img class="lightbox-image" id="lightbox-img" src="">
    </div>
     <script type="module">
        // Dữ liệu menu
        const initialMenuData = { "Dự án": [ { "Loại hình": "Chung cư", "Khu vực": ["TP. Hồ Chí Minh", "Bình Dương", "Đồng Nai"] }, { "Loại hình": "Khu đô thị", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội", "Long An"] } ], "Mua bán": [ { "Loại hình": "Căn hộ", "Khu vực": ["TP. Hồ Chí Minh", "Lâm Đồng"] }, { "Loại hình": "Shophouse", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội"] } ], "Cho thuê": [ { "Loại hình": "Căn hộ", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội"] }, { "Loại hình": "Shophouse", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội"] } ], "Wiki": [ { "Danh mục": "Pháp lý", "slug": "phap-ly" }, { "Danh mục": "Kinh nghiệm", "slug": "kinh-nghiem" } ], "Tin tức": [ { "Danh mục": "Dự án", "slug": "du-an" }, { "Danh mục": "Thị trường", "slug": "thi-truong" } ], "Doanh nghiệp": [ { "Danh mục": "Chủ đầu tư", "slug": "chu-dau-tu" }, { "Danh mục": "Nhà thầu thi công", "slug": "nha-thau-thi-cong" } ] };

        // Logic chính
        document.addEventListener('DOMContentLoaded', () => {
            const header = document.querySelector('.header-wrapper');
            const mainMenu = document.getElementById('main-menu-list');
            const megaMenuContainer = document.getElementById('cct-mega-menu');

            // --- A. LOGIC STICKY HEADER & SIDEBAR ---
            if (header) {
                let lastScrollTop = 0;
                // QUAN TRỌNG: Tìm sidebar BÊN TRONG listener để không gây lỗi ở trang không có sidebar
                const sidebar = document.querySelector('.listing-filter-sidebar, .contact-sidebar, .sidebar-column'); 

                window.addEventListener('scroll', () => {
                    let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    if (scrollTop > lastScrollTop && scrollTop > header.offsetHeight) {
                        header.classList.add('header--hidden');
                        if (sidebar) sidebar.classList.add('sidebar--header-hidden');
                    } else {
                        header.classList.remove('header--hidden');
                        if (sidebar) sidebar.classList.remove('sidebar--header-hidden');
                    }
                    lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
                });
            }
            if (!mainMenu || !megaMenuContainer) return;

            // --- B. LOGIC MENU (Mở/Đóng/Cuộn/Click ngoài) ---
            // (Mã logic menu giữ nguyên như phiên bản cuối cùng trước đó)
            let menuTimeout;
            Object.keys(initialMenuData).forEach(key => { const li = document.createElement('li'); li.innerHTML = `<a href="#">${key}</a>`; li.dataset.key = key; mainMenu.appendChild(li); });
            mainMenu.querySelectorAll('li').forEach(li => {
                li.addEventListener('mouseenter', () => {
                    clearTimeout(menuTimeout);
                    megaMenuContainer.classList.add('is-open');
                    // ... (logic đổ dữ liệu)
                });
                li.addEventListener('mouseleave', () => {
                    menuTimeout = setTimeout(() => megaMenuContainer.classList.remove('is-open'), 300);
                });
            });
            megaMenuContainer.addEventListener('mouseenter', () => clearTimeout(menuTimeout));
            megaMenuContainer.addEventListener('mouseleave', () => {
                menuTimeout = setTimeout(() => megaMenuContainer.classList.remove('is-open'), 300);
            });
            
            function closeMegaMenu() {
                if (megaMenuContainer.classList.contains('is-open')) {
                    megaMenuContainer.classList.remove('is-open');
                }
            }
            window.addEventListener('scroll', closeMegaMenu);
            document.addEventListener('click', (e) => {
                if (!mainMenu.contains(e.target) && !megaMenuContainer.contains(e.target)) {
                    closeMegaMenu();
                }
            });
        });
    </script>
    <script src="assets/js/template.js"></script>
    <script src="assets/js/wiki-data.js"></script>
    <script src="assets/js/news-data.js"></script> <script src="assets/js/article-detail.js"></script> 
    <script src="assets/js/phong_thuy_data.js"></script>
    <script type="module" src="assets/js/data-menu.js"></script>
    <script src="assets/js/estimator-data.js"></script>
    <script src="assets/js/don-gia-data.js"></script>
    <script src="assets/js/estimator-config.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/listing.js"></script>

    
    <script src="assets/js/dataHaoPhi.js"></script> 
    
  
    <script type="module">
    // =====================================================================
    // == SCRIPT TỔNG HỢP CUỐI CÙNG (DESKTOP & MOBILE & STICKY HEADER) ==
    // =====================================================================

    document.addEventListener('DOMContentLoaded', () => {

        // --- PHẦN 1: DỮ LIỆU & BIẾN TOÀN CỤC ---
        const initialMenuData = {
           "Dự án": [ { "Loại hình": "Chung cư", "Khu vực": ["TP. Hồ Chí Minh", "Bình Dương", "Đồng Nai"] }, { "Loại hình": "Khu đô thị", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội", "Long An"] } ],
           "Mua bán": [ { "Loại hình": "Căn hộ", "Khu vực": ["TP. Hồ Chí Minh", "Lâm Đồng", "Bà Rịa - Vũng Tàu"] }, { "Loại hình": "Shophouse", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội", "Đà Nẵng"] } ],
           "Cho thuê": [ { "Loại hình": "Căn hộ", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội"] }, { "Loại hình": "Shophouse", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội", "Vĩnh Long"] } ],
           "Wiki": [ { "Danh mục": "Pháp lý", "slug": "phap-ly" }, { "Danh mục": "Kinh nghiệm", "slug": "kinh-nghiem" }, { "Danh mục": "Phong thuỷ", "slug": "phong-thuy" } ],
           "Tin tức": [ { "Danh mục": "Dự án", "slug": "du-an" }, { "Danh mục": "Thị trường", "slug": "thi-truong" } ],
           "Doanh nghiệp": [ { "Danh mục": "Chủ đầu tư", "slug": "chu-dau-tu" }, { "Danh mục": "Nhà thầu thi công", "slug": "nha-thau-thi-cong" } ]
        };
        
        const featuredProjectsData = [
            {
                name: 'The Global City',
                description: 'Khu đô thị phức hợp chuẩn quốc tế tại TP. Thủ Đức.',
                image: 'assets/images/project-gallery-1.jpg',
                link: '#'
            }
        ];

        const header = document.querySelector('.header-wrapper');
        const mainMenuContainer = document.getElementById('main-nav');
        const mainMenuUl = document.getElementById('main-menu-list');
        const hamburgerButton = document.getElementById('hamburger-button');
        const menuOverlay = document.getElementById('menu-overlay');
        const megaMenuContainer = document.getElementById('cct-mega-menu');
        
        let activeMenuItem = null;
        let menuTimeout;

        // --- PHẦN 2: CÁC HÀM TIỆN ÍCH ---
        const toSlug = (str) => {
            if (!str) return '';
            let s = str.toLowerCase();
            if (s === 'hồ chí minh') return 'tp-ho-chi-minh';
            if (s === 'hà nội') return 'tp-ha-noi';
            if (s === 'đà nẵng') return 'tp-da-nang';
            if (s === 'cần thơ') return 'tp-can-tho';
            if (s === 'hải phòng') return 'tp-hai-phong';
            s = s.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            s = s.replace(/[đĐ]/g, 'd');
            s = s.replace(/([^0-9a-z-\s])/g, '');
            s = s.replace(/(\s+)/g, '-');
            s = s.replace(/-+/g, '-');
            s = s.replace(/^-+|-+$/g, '');
            return s;
        };
        
        function getLink(menuKey, catKey, subItem) {
            let baseUrl = '';
            let params = [];
            const lowerMenuKey = menuKey.toLowerCase();
            const categorySlug = toSlug(catKey);
            if (lowerMenuKey.includes('dự án'))
            baseUrl = 'list-du-an.html';
            else if (lowerMenuKey.includes('bán')) baseUrl = 'listing-ban.html';
            else if (lowerMenuKey.includes('thuê')) baseUrl = 'listing-thue.html';
            else if (lowerMenuKey.includes('wiki')) baseUrl = 'wiki.html';
            else if (lowerMenuKey.includes('tin tức')) baseUrl = 'news.html';
            else if (lowerMenuKey.includes('doanh nghiệp')) baseUrl = 'business.html';
            else baseUrl = 'listing.html';
            if (catKey) {
                let paramKey = ['Dự án', 'Mua bán', 'Cho thuê'].includes(menuKey) ? 'loaihinh' : 'danh-muc';
                params.push(`${paramKey}=${categorySlug}`);
            }
            if (subItem) {
                params.push(`thanhpho=${toSlug(subItem)}`);
            }
            return `${baseUrl}${params.length > 0 ? '?' : ''}${params.join('&')}`;
        }

        function debounce(func, delay = 250) {
            let timeout;
            return (...args) => { clearTimeout(timeout); timeout = setTimeout(() => func.apply(this, args), delay); };
        }

        // --- PHẦN 3: LOGIC MENU ---

        function initMenu() {
            if (window.innerWidth > 1024) {
                handleDesktopMenu();
            } else {
                handleMobileMenu();
            }
        }
        
        function handleDesktopMenu() {
            const nav = document.getElementById('main-nav');
            const mainMenu = document.getElementById('main-menu-list');
            if (!nav || !mainMenu || !megaMenuContainer) return;
            mainMenu.innerHTML = ''; 
            for (const menuKey in initialMenuData) {
                const li = document.createElement('li');
                li.className = 'has-dropdown';
                const a = document.createElement('a');
                a.href = '#'; 
                a.textContent = menuKey;
                li.appendChild(a);
                mainMenu.appendChild(li);
                a.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (activeMenuItem === e.target.parentElement) {
                        closeDesktopPanel();
                    } else {
                        if (activeMenuItem) activeMenuItem.classList.remove('active');
                        activeMenuItem = e.target.parentElement;
                        activeMenuItem.classList.add('active');
                        populateDesktopPanel(menuKey);
                        setTimeout(() => megaMenuContainer.classList.add('is-open'), 10);
                    }
                });
            }
            megaMenuContainer.querySelector('.menu-panel-overlay')?.addEventListener('click', closeDesktopPanel);
            nav.addEventListener('mouseleave', () => { menuTimeout = setTimeout(closeDesktopPanel, 300); });
            nav.addEventListener('mouseenter', () => clearTimeout(menuTimeout));
            megaMenuContainer.addEventListener('mouseenter', () => clearTimeout(menuTimeout));
            megaMenuContainer.addEventListener('mouseleave', () => { menuTimeout = setTimeout(closeDesktopPanel, 300); });
        }

        // =======================================================
        // == HÀM ĐÃ ĐƯỢC CẬP NHẬT ĐẦY ĐỦ LOGIC MỚI NHẤT ==
        // =======================================================
        function populateDesktopPanel(menuKey) {
            const menuItems = initialMenuData[menuKey];
            const col1Header = document.querySelector('#cct-mega-menu .menu-panel-col.col-1 h4'); // --- ĐÃ THÊM ---
            const col1List = document.getElementById('mega-menu-col-1-list');
            const col2List = document.getElementById('mega-menu-col-2-list');
            const col3Content = document.getElementById('mega-menu-col-3-content');

            if (!col1List || !col2List || !col3Content || !col1Header) return; // --- ĐÃ SỬA ---
            
            col1List.innerHTML = '';
            col2List.innerHTML = '';
            col3Content.innerHTML = '';

            if (!menuItems || menuItems.length === 0) {
                col1Header.textContent = '';
                return;
            }

            // --- ĐÃ THÊM: LOGIC TỰ ĐỘNG ĐẶT TIÊU ĐỀ ---
            const firstItem = menuItems[0];
            let col1Title = '';
            if (firstItem.hasOwnProperty('Loại hình')) {
                col1Title = 'Loại hình';
            } else if (firstItem.hasOwnProperty('Danh mục')) {
                col1Title = 'Danh mục';
            }
            col1Header.textContent = col1Title;
            // --- KẾT THÚC PHẦN THÊM MỚI ---

            const isMega = firstItem.hasOwnProperty('Khu vực');
            megaMenuContainer.querySelector('.menu-panel-columns').classList.toggle('is-single-col-data', !isMega);
            
            menuItems.forEach((item, index) => {
                const categoryName = item["Loại hình"] || item["Danh mục"];
                const li = document.createElement('li');
                li.dataset.category = categoryName;
                if (isMega) {
                    li.textContent = categoryName;
                } else {
                    const link = document.createElement('a');
                    link.href = getLink(menuKey, categoryName);
                    link.textContent = categoryName;
                    link.className = 'direct-link';
                    li.appendChild(link);
                }
                if (index === 0) li.classList.add('active');
                col1List.appendChild(li);
            });

            if (isMega) {
                updateDesktopSubMenu(menuItems[0]["Loại hình"], menuKey);
                col1List.addEventListener('mouseover', e => {
                    const targetLi = e.target.closest('li');
                    if (targetLi && targetLi.dataset.category) {
                        col1List.querySelectorAll('li').forEach(li => li.classList.remove('active'));
                        targetLi.classList.add('active');
                        updateDesktopSubMenu(targetLi.dataset.category, menuKey);
                    }
                });
            }
            
            featuredProjectsData.forEach(project => {
                const card = document.createElement('a');
                card.href = project.link;
                card.className = 'featured-project-card';
                card.innerHTML = `<img src="${project.image}" alt="${project.name}"><div class="featured-project-info"><h5>${project.name}</h5><p>${project.description}</p></div>`;
                col3Content.appendChild(card);
            });
        }
        
        function updateDesktopSubMenu(categoryKey, menuKey) {
            const subMenuContainer = document.getElementById('mega-menu-col-2-list');
            const menuItems = initialMenuData[menuKey];
            const targetItem = menuItems.find(item => item["Loại hình"] === categoryKey);
            const subItems = targetItem ? targetItem["Khu vực"] : [];
            subMenuContainer.innerHTML = subItems.map(item => `<li><a href="${getLink(menuKey, categoryKey, item)}">${item}</a></li>`).join('');
        }

        function closeDesktopPanel() {
            if (megaMenuContainer) megaMenuContainer.classList.remove('is-open');
            if (activeMenuItem) {
                activeMenuItem.classList.remove('active');
                activeMenuItem = null;
            }
        }

        function handleMobileMenu() {
            const nav = document.getElementById('main-nav');
            const overlay = document.getElementById('menu-overlay');
            const hamburger = document.getElementById('hamburger-button');
            if (!nav || !overlay || !hamburger) return;
            nav.innerHTML = '<div class="menu-slider"></div>';
            const slider = nav.querySelector('.menu-slider');
            const createPanel = (level, title, content) => {
                const panel = document.createElement('div');
                panel.className = 'menu-panel';
                panel.dataset.level = level;
                let headerHTML = `<h4 class="panel-title">${title}</h4>`;
                if (level > 0) {
                    headerHTML = `<a href="#" class="panel-back-button"><svg fill="currentColor" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg></a>` + headerHTML;
                } else {
                    headerHTML += `<button class="mobile-menu-close">&times;</button>`;
                }
                panel.innerHTML = `<div class="panel-header">${headerHTML}</div><ul class="panel-list">${content}</ul>`;
                return panel;
            };
            const openMenu = () => {
                if (!slider.querySelector('[data-level="0"]')) {
                    const level1Content = Object.keys(initialMenuData).map(key => `<li class="has-submenu" data-level="0" data-key="${key}"><a href="#">${key}</a></li>`).join('');
                    const panel1 = createPanel(0, 'Menu', level1Content);
                    slider.appendChild(panel1);
                    panel1.querySelector('.mobile-menu-close').addEventListener('click', closeMenu);
                }
                nav.classList.add('is-open');
                overlay.classList.add('is-visible');
                document.body.style.overflow = 'hidden';
            };
            const closeMenu = () => {
                nav.classList.remove('is-open');
                overlay.classList.remove('is-visible');
                document.body.style.overflow = '';
                setTimeout(() => {
                    slider.style.transform = 'translateX(0%)';
                    slider.querySelectorAll('.menu-panel').forEach(p => { if (p.dataset.level > 0) p.remove(); });
                }, 350);
            };
            hamburger.onclick = openMenu;
            overlay.onclick = closeMenu;
            slider.addEventListener('click', (e) => {
                const linkTarget = e.target.closest('a');
                if (linkTarget && linkTarget.getAttribute('href') !== '#') {
                    closeMenu();
                    return;
                }
                e.preventDefault();
                const target = e.target;
                const currentPanel = target.closest('.menu-panel');
                if (!currentPanel) return;
                if (target.closest('.panel-back-button')) {
                    const currentLevel = parseInt(currentPanel.dataset.level, 10);
                    slider.style.transform = `translateX(-${(currentLevel - 1) * 100}%)`;
                    setTimeout(() => currentPanel.remove(), 350);
                    return;
                }
                const targetLi = target.closest('li[data-key]');
                if (targetLi) {
                    if(e.target.closest('a')?.getAttribute('href') === '#') { e.preventDefault(); }
                    const level = parseInt(targetLi.dataset.level, 10);
                    const menuKey = targetLi.dataset.key;
                    const category = targetLi.dataset.category;
                    let nextLevelContent = '', nextLevelTitle = '';
                    if (level === 0) {
                        nextLevelTitle = menuKey;
                        const items = initialMenuData[menuKey];
                        nextLevelContent = items.map(item => {
                            const name = item["Loại hình"] || item["Danh mục"];
                            const hasSubmenu = item.hasOwnProperty('Khu vực');
                            const link = hasSubmenu ? '#' : getLink(menuKey, name, null);
                            return `<li class="${hasSubmenu ? 'has-submenu' : ''}" data-level="1" data-key="${menuKey}" data-category="${name}"><a href="${link}">${name}</a></li>`;
                        }).join('');
                    }
                    else if (level === 1) {
                        const parentItem = initialMenuData[menuKey].find(item => (item["Loại hình"] || item["Danh mục"]) === category);
                        if (!parentItem || !parentItem["Khu vực"]) return;
                        nextLevelTitle = category;
                        const khuVucItems = parentItem["Khu vực"];
                        nextLevelContent = khuVucItems.map(kv => `<li><a href="${getLink(menuKey, category, kv)}">${kv}</a></li>`).join('');
                    }
                    if (nextLevelContent) {
                        const newPanel = createPanel(level + 1, nextLevelTitle, nextLevelContent);
                        slider.appendChild(newPanel);
                        slider.style.transform = `translateX(-${(level+1) * 100}%)`;
                    }
                }
            });
        }
        
        // --- PHẦN 4: CÁC SỰ KIỆN TOÀN CỤC ---
        if (header) {
            let lastScrollTop = 0;
            const sidebar = document.querySelector('.listing-filter-sidebar, .contact-sidebar, .sidebar-column'); 
            window.addEventListener('scroll', () => {
                let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                if (scrollTop > lastScrollTop && scrollTop > header.offsetHeight) {
                    header.classList.add('header--hidden');
                    if (sidebar) sidebar.classList.add('sidebar--header-hidden');
                } else {
                    header.classList.remove('header--hidden');
                    if (sidebar) sidebar.classList.remove('sidebar--header-hidden');
                }
                lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
                if (megaMenuContainer && megaMenuContainer.classList.contains('is-open')) {
                    closeDesktopPanel();
                }
            });
        }

        document.addEventListener('click', (event) => {
            if (megaMenuContainer && mainMenuContainer && megaMenuContainer.classList.contains('is-open')) {
                if (!mainMenuContainer.contains(event.target) && !megaMenuContainer.contains(event.target)) {
                    closeDesktopPanel();
                }
            }
        });

        window.addEventListener('resize', debounce(initMenu, 250));
        
        // --- PHẦN 5: KHỞI CHẠY LẦN ĐẦU ---
        initMenu();
    });
    </script>
    <div id="nam-mua-nha-modal" class="modal-container">
    <div class="modal-content">
        <button class="modal-close-btn" title="Đóng">×</button>

        <div id="xay-nha-input-wrapper">
            <h3>Kiểm tra năm mua/xây nhà</h3>
            <p>Nhập thông tin của bạn và năm dự kiến xây nhà để nhận phân tích chi tiết.</p>
            <div class="modal-separator"></div>
            <form id="xay-nha-form" class="contact-form">
                <input type="text" inputmode="numeric" name="birth_year" placeholder="Năm sinh của bạn (VD: 1990)" required>
                <select name="gender" required>
                    <option value="" disabled selected>Chọn giới tính</option>
                    <option value="Nam">Nam</option>
                    <option value="Nữ">Nữ</option>
                </select>
                <input type="text" inputmode="numeric" name="build_year" placeholder="Năm dự kiến mua/xây nhà (VD: 2025)" required>
                <div id="xay-nha-error" style="color: red; font-size: 14px; margin-top: -5px; margin-bottom: 10px; text-align: left; display: none;"></div>
                <button type="submit" class="btn-primary">Xem kết quả</button>
            </form>
        </div>

        <div id="xay-nha-result-wrapper" style="display: none;">
            <h3 id="xay-nha-result-title">Tổng quan tuổi làm nhà</h3>
            
            <div id="xay-nha-info-grid" class="info-grid">
                <div id="xay-nha-info-col-1"></div>
                <div id="xay-nha-info-col-2"></div>
            </div>

            <div id="xay-nha-details"></div>

            <div id="xay-nha-suggestions"></div>
            <p class="modal-disclaimer">
                <strong>Lưu ý quan trọng:</strong> Các kết quả và thông tin được cung cấp bởi tiện ích này chỉ mang tính chất tham khảo và giải trí. Chúng tôi không đảm bảo tính chính xác tuyệt đối và không chịu bất kỳ trách nhiệm nào về các quyết định, hành động, hoặc tổn thất của người dùng dựa trên những thông tin này.
            </p>

            <button id="xay-nha-back-btn" class="btn-secondary-custom" style="margin-top: 20px;">Tra cứu lại</button>
        </div>
    </div>
</div>
<div id="khai-toan-xay-dung-modal" class="modal-container">
    <div class="modal-content" style="max-width: 1100px;">
        <button class="modal-close-btn" title="Đóng">&times;</button>
        <div class="estimator-wrapper">
            <h1 class="estimator-title">Dự Toán Chi Phí Xây Dựng</h1>
            <p class="estimator-subtitle">Hoàn thành 3 bước đơn giản để nhận báo giá sơ bộ chính xác nhất.</p>

            <div id="stepper" class="estimator-stepper">
                <div class="stepper-track">
                    <div id="step-item-1" class="step-item active">
                        <div class="step-circle">1</div>
                        <div class="step-label">
                            <div class="step-title">Thông số</div>
                            <div class="step-desc">Nhập thông tin</div>
                        </div>
                        <div class="step-line"></div>
                    </div>
                    <div id="step-item-2" class="step-item">
                        <div class="step-circle">2</div>
                        <div class="step-label">
                            <div class="step-title">Đơn giá</div>
                            <div class="step-desc">Tùy chỉnh</div>
                        </div>
                        <div class="step-line"></div>
                    </div>
                    <div id="step-item-3" class="step-item">
                        <div class="step-circle">3</div>
                        <div class="step-label">
                            <div class="step-title">Kết quả</div>
                            <div class="step-desc">Xem dự toán</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="step-1">
                <div class="estimator-layout">
                    <form id="construction-form" class="estimator-form">
                        <div class="form-grid">
                            <fieldset class="form-fieldset full-width">
                                <legend>Thông Tin Chung</legend>
                                <div class="form-grid-columns three-cols">
                                    <div class="form-group">
                                        <label for="khu-vuc">Khu vực thi công</label>
                                        <select id="khu-vuc">
                                            <option>Hồ Chí Minh</option>
                                            <option>Đồng Nai</option>
                                            <option>Long An</option>
                                            <option>Khác</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="loai-cong-trinh">Loại hình công trình</label>
                                        <select id="loai-cong-trinh">
                                            
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-tooltip">
                                            <label for="loai-cong-trinh">Gói vật liệu hoàn thiện</label>
                                            <div class="tooltip-container">
                                                <svg class="tooltip-icon" xmlns="http://www.w3.org/2000/svg" height="16px" viewBox="0 0 24 24" width="16px" fill="currentColor">
                                                <path d="M0 0h24v24H0V0z" fill="none"/>
                                                <path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                                                </svg>
                                                <div class="tooltip-text">
                                                    <b>Phần hoàn thiện được quy định:</b> đứng trong nhà thứ gì có thể thấy được (không bao gồm nội thất) thì được xem là hoàn thiện: Gạch ốp lát, trần, đèn, thiết bị vệ sinh, cửa, ổ cắm công tắc, sơn nước,...
                                                </div>
                                            </div>
                                        </div>
                                        <div class="radio-group">
                                            <label><input type="radio" name="vat-lieu" value="Thuong" checked> Thường</label>
                                            <label><input type="radio" name="vat-lieu" value="Kha"> Khá</label>
                                            <label><input type="radio" name="vat-lieu" value="Tot"> Tốt</label>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                            <fieldset class="form-fieldset full-width">
                                <legend>Kết Cấu & Quy Mô</legend>
                                <div class="form-grid-columns three-cols">
                                    <div class="form-group">
                                        <div class="label-with-tooltip">
                                            <label>Loại móng</label>
                                            <div class="tooltip-container">
                                                <svg class="tooltip-icon" xmlns="http://www.w3.org/2000/svg" height="16px" viewBox="0 0 24 24" width="16px" fill="currentColor">
                                                <path d="M0 0h24v24H0V0z" fill="none"/>
                                                <path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                                                </svg>
                                                <div class="tooltip-text">
                                                    Không bao gồm phần cọc, khối lượng cọc sẽ được tính theo thực tế thi công.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="radio-group">
                                            <label><input type="radio" name="mong" value="Móng đơn/băng" checked> Móng đơn/băng</label>
                                            <label><input type="radio" name="mong" value="Móng cọc"> Móng cọc</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="tang-ham">Tầng hầm</label>
                                        <select id="tang-ham">
                                            <option>Không</option>
                                            <option>Bán hầm</option>
                                            <option>1 hầm</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="so-tang">Số tầng nổi</label>
                                        <input type="number" id="so-tang" value="3" min="1" max="10">
                                        <p id="so-tang-error" class="form-error-message hidden"></p>
                                    </div>
                                </div>
                            </fieldset>
                            <fieldset class="form-fieldset full-width">
                                <legend>Kích Thước</legend>
                                <div class="form-grid-columns three-cols">
                                    <div class="form-group">
                                        <label for="chieu-dai">Chiều dài nhà (m)</label>
                                        <input type="number" id="chieu-dai" value="15" min="5">
                                        <p id="chieu-dai-error" class="form-error-message hidden"></p>
                                    </div>
                                    <div class="form-group">
                                        <label for="chieu-rong">Chiều rộng nhà (m)</label>
                                        <input type="number" id="chieu-rong" value="5" min="3">
                                        <p id="chieu-rong-error" class="form-error-message hidden"></p>
                                    </div>
                                    <div class="form-group">
                                        <label for="dien-tich">Diện tích xây dựng (m²)</label>
                                        <input type="number" id="dien-tich" readonly>
                                    </div>
                                </div>
                            </fieldset>
                            
                            <fieldset id="mai-only-fieldset" class="form-fieldset full-width hidden">
                                <legend>Thông Tin Mái</legend>
                                <div class="form-grid-columns two-cols">
                                    <div class="form-group">
                                        <label for="loai-mai-sotang-1">Loại mái</label>
                                        <select id="loai-mai-sotang-1">
                                            <option>Mái bằng – BTCT</option>
                                            <option>Mái tôn gác xà gỗ đơn giản</option>
                                            <option>Mái ngói</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="dien-tich-mai-sotang-1">Diện tích mái (m²)</label>
                                        <input type="number" id="dien-tich-mai-sotang-1" value="75">
                                        <p id="dt-mai-sotang-1-error" class="form-error-message hidden"></p>
                                    </div>
                                </div>
                            </fieldset>

                            <fieldset id="hang-muc-mo-rong-fieldset" class="form-fieldset full-width">
    <legend>Hạng Mục Mở Rộng</legend>
    <p id="combined-area-error" class="form-error-message hidden"></p>

    <div class="form-grid-columns two-cols">
        <div class="form-group toggle-group">
            <label>Ban công trước</label>
            <div class="toggle-switch">
                <input type="checkbox" id="ban-cong-truoc-toggle" class="toggle-checkbox"/>
                <label for="ban-cong-truoc-toggle" class="toggle-label"></label>
            </div>
        </div>
        <div id="dien-tich-bc-truoc-container" class="form-group hidden">
            <label for="dien-tich-bc-truoc">DT ban công trước (m²)</label>
            <input type="number" id="dien-tich-bc-truoc" value="6">
            <p id="dt-bc-truoc-error" class="form-error-message hidden"></p>
        </div>

        <div class="form-group toggle-group">
            <label>Ban công sau</label>
            <div class="toggle-switch">
                <input type="checkbox" id="ban-cong-sau-toggle" class="toggle-checkbox"/>
                <label for="ban-cong-sau-toggle" class="toggle-label"></label>
            </div>
        </div>
        <div id="dien-tich-bc-sau-container" class="form-group hidden">
            <label for="dien-tich-bc-sau">DT ban công sau (m²)</label>
            <input type="number" id="dien-tich-bc-sau" value="4">
            <p id="dt-bc-sau-error" class="form-error-message hidden"></p>
        </div>
    </div>

    <div class="form-separator full-width"></div>
    <div class="form-grid-columns two-cols full-width">
        <div class="form-group">
            <label for="san-thuong">Loại Sân thượng</label>
            <select id="san-thuong">
               
            </select>
        </div>
        
        <div id="loai-mai-container" class="form-group hidden">
            <label for="loai-mai">Loại mái</label>
            <select id="loai-mai">
                <option>Mái bằng – BTCT</option>
                <option>Mái tôn gác xà gỗ đơn giản</option>
                <option>Mái ngói</option>
            </select>
        </div>
        <div id="dien-tich-mai-container" class="form-group hidden">
            <label for="dien-tich-mai">Diện tích mái (m²)</label>
            <input type="number" id="dien-tich-mai" value="75">
            <p id="dt-mai-error" class="form-error-message hidden"></p>
        </div>
        <div id="dien-tich-tum-container" class="form-group hidden">
            <label for="dien-tich-tum">Diện tích tum thang (m²)</label>
            <input type="number" id="dien-tich-tum">
            <p id="dt-tum-error" class="form-error-message hidden"></p>
        </div>
        <div id="dien-tich-st-trong-container" class="form-group hidden">
            <label for="dien-tich-st-trong">DT sân thượng trống (m²)</label>
            <input type="number" id="dien-tich-st-trong">
            <p id="dt-st-trong-error" class="form-error-message hidden"></p>
        </div>
        <div id="dien-tich-gian-hoa-container" class="form-group hidden">
            <label for="dien-tich-gian-hoa">DT giàn hoa/mái tôn (m²)</label>
            <input type="number" id="dien-tich-gian-hoa" value="20">
            <p id="dt-gian-hoa-error" class="form-error-message hidden"></p>
        </div>
        <div id="dien-tich-mai-ngoi-container" class="form-group hidden">
            <label for="dien-tich-mai-ngoi">Diện tích mái ngói (m²)</label>
            <input type="number" id="dien-tich-mai-ngoi" value="30">
            <p id="dt-mai-ngoi-error" class="form-error-message hidden"></p>
        </div>
        <div id="loai-phong-container" class="form-group hidden">
            <label for="loai-phong">Loại phòng trên sân thượng</label>
            <select id="loai-phong">
               
            </select>
        </div>
        <div id="dien-tich-phong-container" class="form-group hidden">
            <label for="dien-tich-phong">Diện tích phòng (m²)</label>
            <input type="number" id="dien-tich-phong" value="25">
            <p id="dt-phong-error" class="form-error-message hidden"></p>
        </div>
    </div>
</fieldset>
                        </div>
                    </form>

                    <div class="estimator-preview">
                        <div class="estimator-preview estimator-preview-sticky">
                            <div class="estimator-image-wrapper">
                                <div class="image-slider-container">
                                    <img id="cong-trinh-image" src="https://placehold.co/800x600/cccccc/FFFFFF?text=Chọn+đủ+thông+tin" alt="Ảnh minh họa công trình" class="cursor-zoom-in">
                                    <div class="slider-controls">
                                        <button id="prev-image" class="slider-button" title="Ảnh trước">←</button>
                                        <span id="image-index">0/0</span>
                                        <button id="next-image" class="slider-button" title="Ảnh sau">→</button>
                                    </div>
                                </div>
                                <p id="cong-trinh-caption">Chọn các tùy chọn để xem hình ảnh minh họa.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="step-2" class="hidden">
                <div style="text-align: center; margin-bottom: 24px;">
                    <h2 style="font-size: 20px; font-weight: 600; color: var(--text-dark);">Bước 2: Tùy Chỉnh Đơn Giá Vật Tư & Nhân Công</h2>
                    <p style="color: var(--text-light); margin-top: 4px;">
                        Đơn giá dưới đây được đề xuất cho khu vực 
                        <span id="khu-vuc-don-gia" style="font-weight: 700; color: var(--primary-color);">Hồ Chí Minh</span>. 
                        Bạn có thể chỉnh sửa nếu cần.
                    </p>
                </div>
                
                <div class="table-scroll-wrapper">
                    <p style="text-align: center;"><i>(Nội dung bảng tùy chỉnh đơn giá sẽ được phát triển ở giai đoạn sau.)</i></p>
                </div>
            </div>

            <div id="step-3" class="hidden">
                <div style="text-align: center; margin-bottom: 24px;">
                    <h2 style="font-size: 20px; font-weight: 600; color: var(--text-dark);">Bước 3: Kết Quả Dự Toán Chi Tiết</h2>
                    <p style="color: var(--text-light); margin-top: 4px;">Dưới đây là chi phí dự toán dựa trên thông số bạn cung cấp.</p>
                </div>

                <div id="total-cost-summary-container" style="background-color: #F0FFF4; border: 2px solid #C6F6D5; border-radius: 8px; padding: 24px; margin-bottom: 32px;">
                </div>

                <div style="margin-bottom: 32px; display: flex; flex-direction: column; gap: 12px;">
                    <details id="converted-area-details" style="background-color: #F7FAFC; padding: 16px; border-radius: 8px;">
                        <summary style="font-weight: 600; cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                            <span>Xem chi tiết cách tính Diện tích Quy đổi</span>
                            <span id="total-converted-area-span" style="font-size: 18px; font-weight: 700; color: var(--text-dark);">Tổng: ... m²</span>
                        </summary>
                        <div id="converted-area-table-container" style="margin-top: 16px;">
                             <p style="font-size: 14px; color: var(--text-light); margin-top: 8px;">Điền đầy đủ thông tin ở Bước 1 để xem kết quả.</p>
                        </div>
                    </details>
                    
                    <details style="background-color: #F7FAFC; padding: 16px; border-radius: 8px;">
                        <summary style="font-weight: 600; cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                            <span>Xem chi tiết dự toán chi phí</span>
                        </summary>
                        <div id="step-3-result-wrapper" style="margin-top: 16px;"></div>
                    </details>
                </div>

                <div style="margin-top: 40px; display: flex; justify-content: space-between; align-items: center;">
                    <button id="back-btn-step3" style="background-color: #E2E8F0; color: #2D3748; padding: 10px 24px; border-radius: 8px; font-weight: 600; border: 1px solid #CBD5E0;">
                        Quay lại
                    </button>
                    <button id="restart-btn" style="background-color: #E2E8F0; color: #2D3748; padding: 10px 24px; border-radius: 8px; font-weight: 600; border: 1px solid #CBD5E0;">
                        🔄 Tính Lại Từ Đầu
                    </button>
                </div>
            </div>

            <div id="navigation-buttons" class="estimator-navigation">
                <button id="back-btn" disabled>Quay lại</button>
                <button id="next-btn" class="btn-primary">Tiếp tục</button>
            </div>
        </div>
    </div>
</div>

<div id="image-zoom-modal" class="estimator-zoom-modal hidden">
    <span id="close-zoom-modal">&times;</span>
    <img id="zoomed-image" src="" alt="Ảnh công trình phóng to">
</div>
</body>
</html>