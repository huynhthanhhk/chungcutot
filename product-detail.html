<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BĐS Tốt - Tiêu đề</title>
    
   <link rel="icon" href="favicon.png" type="image/png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/menu.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/product-detail.css">
    <link rel="stylesheet" href="assets/css/listing.css">
</head>
<body>

    
    <div id="menu-overlay" class="menu-overlay"></div>
    <header class="header-wrapper">
        <div class="header-footer-limiter">
            <div class="site-header">
                <button class="hamburger-button" id="hamburger-button" aria-label="Mở menu">
                    <span class="bar"></span><span class="bar"></span><span class="bar"></span>
                </button>
                <a href="index.html" class="logo-link"><img src="assets/images/logo.png" alt="Logo Chung Cư Tốt" class="logo"></a>
                <nav class="main-nav" id="main-nav">
                    <ul id="main-menu-list"></ul>
                </nav>
                <div class="header-actions">
                    <a href="favorites.html" class="header-favorite-btn" aria-label="Danh sách yêu thích">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>
                        <span class="favorite-counter">0</span>
                    </a>
                    <a href="#" class="search-button-new" aria-label="Tìm kiếm">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/></svg>
                    </a>
                </div>
            </div>
        </div>
    </header>
    <div id="cct-mega-menu">
    <div class="menu-panel-overlay"></div>
    <div class="menu-panel-columns">
        <div class="menu-panel-col col-1">
            <h4>Loại hình</h4>
            <ul id="mega-menu-col-1-list"></ul>
        </div>
        <div class="menu-panel-col col-2">
            <h4>Khu vực</h4>
            <ul id="mega-menu-col-2-list"></ul>
        </div>
        <div class="menu-panel-col col-3">
            <h4>Dự án nổi bật</h4>
            <div id="mega-menu-col-3-content"></div>
        </div>
    </div>
    </div>
    <main class="main-container">
        <div class="content-limiter">

            <section class="hero-slider-container">
                <div class="hero-slider">
                    <div class="slider-track">
                        </div>
                    <div class="hero-actions">
                        <button class="action-button favorite-btn" title="Thêm vào yêu thích">
                            <svg class="heart-outline" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"></path>
                        </svg>
                        
                        <svg class="heart-solid" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path>
                        </svg>
                        </button>
                        <button class="action-button share-btn" aria-label="Chia sẻ">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18 8h-3v2h3v11H6V10h3V8H6c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM11 5.5V16h2V5.5l2.3 2.3 1.4-1.4L12 1.8l-4.7 4.6 1.4 1.4L11 5.5z"/>
                            </svg>
                        </button>
                        <div id="share-popup" class="share-popup">
                            <div class="share-popup-header">
                                <h4>Chia sẻ liên kết</h4>
                                <button id="close-share-popup" class="close-share-btn" title="Đóng">&times;</button>
                            </div>
                            <div class="share-popup-body">
                                <button id="copy-link-btn" class="share-option">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                                    <span>Sao chép liên kết</span>
                                </button>
                                <div class="social-share-options">
                                    <a href="#" id="share-facebook" class="social-icon" title="Facebook" target="_blank"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m13 2h-2.5a3.5 3.5 0 0 0-3.5 3.5V11h-2v3h2v7h3v-7h3v-3h-3V8.5A.5.5 0 0 1 15 8h3V5z"></path></svg></a>
                                    <a href="#" id="share-zalo" class="social-icon" title="Zalo" target="_blank"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12a5 5 0 0 0-5-5H3v10h4a5 5 0 0 0 5-5zm0 0a5 5 0 0 1 5-5h4v10h-4a5 5 0 0 1-5-5z"></path></svg></a>
                                    <a href="#" id="share-telegram" class="social-icon" title="Telegram" target="_blank"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.58c-.28 1.13-1.04 1.4-1.74 .88l-4.92-3.6l-2.38 2.31c-.26.25-.6.39-.96.26z"></path></svg></a>
                                    <a href="#" id="share-email" class="social-icon" title="Email" target="_blank"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="slider-controls">
                    <div class="slider-dots">
                        </div>
                    <button class="play-pause-btn" title="Dừng/Tiếp tục">
                        <svg class="icon-pause" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                        <svg class="icon-play" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
                    </button>
                </div>
                
                <div class="view-all-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zm8 0A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm-8 8A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm8 0A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3z"></path></svg>
                    <span>Xem tất cả ảnh</span>
                </div>
            </section>
            <div id="image-gallery-popup" class="image-gallery-popup">
                <div class="gallery-backdrop"></div>
                <button class="gallery-close-btn" title="Đóng">×</button>
                <div class="gallery-container">
                    <div class="gallery-main-view">
                        <img id="gallery-main-image" src="" alt="Ảnh chính của sản phẩm">
                        <button class="gallery-nav-btn prev" title="Ảnh trước">❮</button>
                        <button class="gallery-nav-btn next" title="Ảnh kế tiếp">❯</button>
                        <div id="gallery-caption" class="gallery-caption"></div>
                    </div>
                    <div class="gallery-thumbnail-strip">
                        </div>
                </div>
            </div>       
            <div class="product-detail-layout">

                <div class="product-content-column">
                    <div class="breadcrumb">
                        <a href="index.html">Trang chủ</a> > <a href="listing-ban.html">Bán căn hộ</a> > Masteri Centre Point
                    </div>

                    <h1>Bán Căn Hộ 2PN Masteri Centre Point, View Sông, Giá Tốt</h1>
                    <p class="address-line">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
                        Đại đô thị Vinhomes Grand Park, TP. Thủ Đức, TP.HCM
                    </p>

                    <div class="highlight-info-box">
                        <div class="info-item price-item">
                            <span class="info-value price-value">4.5 tỷ</span>
                            <span class="info-unit-price">~ 60 triệu/m²</span>
                        </div>
                        
                        <div class="other-specs-group">
                            <div class="info-item">
                                <span class="info-label">Diện tích</span>
                                <span class="info-value">75 m²</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Phòng ngủ</span>
                                <span class="info-value">2</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">WC</span>
                                <span class="info-value">2</span>
                            </div>
                        </div>
                    </div>

                    <div class="description-content">
                        <h2>Mô tả chi tiết</h2>
                        <p>Cần bán gấp căn hộ 2 phòng ngủ tại dự án Masteri Centre Point. Căn hộ có tầm nhìn trực diện sông Đồng Nai, thoáng đãng, không bị che chắn. Thiết kế hiện đại, bàn giao kèm nội thất cơ bản từ chủ đầu tư, bao gồm các thiết bị từ thương hiệu quốc tế như Kohler, Hafele, Daikin.</p>
                        <p>Khu compound an ninh 24/7, tận hưởng hệ sinh thái tiện ích đẳng cấp của cả Masterise Homes và Vingroup. Pháp lý rõ ràng, đã có hợp đồng mua bán, hỗ trợ vay ngân hàng.</p>
                    </div>

                    <div class="detailed-info-table">
                        <h2>Thông tin chi tiết</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>Thuộc tính</th>
                                    <th>Giá trị</th>
                                </tr>
                            </thead>
                            <tbody id="product-detail-tbody">
                                </tbody>
                        </table>
                    </div>

                    <div class="similar-listings-link-box">
                        <div class="similar-listings-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M10 3H3v7h7V3zm0 11H3v7h7v-7zM17 3h-7v7h7V3zm0 11h-7v7h7v-7z"/></svg>
                        </div>
                        <div class="similar-listings-content">
                            <h4>Tìm các bất động sản tương tự</h4>
                            <p>Khám phá thêm các sản phẩm khác tại phường <strong id="similar-ward-name"></strong> để có thêm nhiều lựa chọn phù hợp.</p>
                        </div>
                        <a href="#" class="similar-listings-cta" id="similar-listings-cta-link">
                            <span>Xem thêm</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg>
                        </a>
                    </div>
                    <div class="project-card-link">
                        <img src="" alt="Thumbnail dự án Masteri Centre Point" class="project-thumbnail">
                        
                        <div class="project-content">
                            <h5>Thông tin dự án</h5>
                            <p>Sản phẩm này thuộc dự án <a href="#">Masteri Centre Point</a>.</p>
                            <a href="#" class="project-cta-link">Xem chi tiết dự án →</a>
                        </div>
                    </div>
                    
                    

                    <div class="loan-calculator">
                        <h2>Công cụ ước tính lãi vay</h2>
                        <p style="text-align: left; margin-top: -10px; margin-bottom: 25px; color: var(--text-light);">Công cụ giúp bạn lập kế hoạch tài chính chi tiết và đưa ra quyết định vay vốn thông minh.</p>

                        <form id="loan-calculator-form" class="loan-calculator-form">
                            <div class="lc-form-grid">
                                <div class="lc-form-group">
                                    <label for="lc-property-value">Giá trị nhà đất (tỷ VNĐ)</label>
                                    <input type="number" id="lc-property-value" name="propertyValue" value="4.5" step="any" min="0" required>
                                </div>
                                <div class="lc-form-group">
                                    <label for="lc-method">Phương thức tính</label>
                                    <select id="lc-method" name="method">
                                        <option value="annuity">Lãi vay và gốc cố định</option>
                                        <option value="reducing_balance" selected>Dư nợ giảm dần, gốc trả đều</option>
                                    </select>
                                </div>

                                <div class="lc-form-group lc-full-width">
                                    <label for="lc-loan-amount">Số tiền vay (tỷ VNĐ)</label>
                                    <input type="number" id="lc-loan-amount" name="loanAmount" value="3.15" step="any" min="0" required>
                                    <div class="lc-slider-wrapper">
                                        <input type="range" id="lc-loan-slider" name="loanSlider" min="0" max="100" step="1" value="70">
                                        <span id="lc-loan-percentage">Vay 70%</span>
                                    </div>
                                </div>
                                
                                <div class="lc-form-group">
                                    <label for="lc-loan-term">Thời gian vay (tháng)</label>
                                    <input type="number" id="lc-loan-term" name="loanTerm" value="240" min="0" required>
                                </div>
                                <div class="lc-form-group">
                                    <label for="lc-annual-rate">Lãi suất năm (%)</label>
                                    <input type="number" id="lc-annual-rate" name="annualRate" value="7.5" step="0.1" min="0" required>
                                </div>

                                <div class="lc-form-group">
                                    <label for="lc-promo-months">Số tháng ưu đãi</label>
                                    <input type="number" id="lc-promo-months" name="promoMonths" value="0" min="0">
                                </div>
                                <div class="lc-form-group" id="lc-promo-rate-group">
                                    <label for="lc-promo-rate">Lãi suất ưu đãi (%)</label>
                                    <input type="number" id="lc-promo-rate" name="promoRate" value="7.5" step="0.1" min="0">
                                </div>
                                
                                <div class="lc-form-group lc-button-group lc-full-width">
                                    <button type="submit" class="btn-primary">Ước tính lãi vay</button>
                                </div>
                            </div>
                        </form>

                        <div id="lc-results-wrapper" class="lc-results-wrapper" style="display: none;">
                                <div class="lc-results-left">
                                    <div class="lc-summary-header">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor">
                    <title>Account Balance Icon</title>
                    <path d="M0 0h24v24H0V0z" fill="none"/>
                    <path d="M4 10v7h3v-7H4zm6 0v7h3v-7h-3zM2 22h19v-3H2v3zm14-12v7h3v-7h-3zm-4.5-9L2 6v2h19V6l-9.5-5z"/>
                    </svg>
                                        <h4>Kết quả ước tính</h4>
                                    </div>
                                    <div class="lc-summary-item">
                                        <span class="label">Số tiền trả hàng tháng</span>
                                        <div class="value" id="lc-monthly-payment-result"></div>
                                    </div>
                                    <div class="lc-summary-item">
                                        <span class="label">Tổng lãi phải trả</span>
                                        <div class="value" id="lc-total-interest-result"></div>
                                    </div>
                                    <button id="lc-show-schedule-btn" class="btn-secondary-custom">Xem chi tiết lịch trả nợ</button>
                                </div>
                                <div class="lc-results-right">
                                    <div id="lc-payment-chart" class="lc-payment-chart"></div>
                                    <div id="lc-chart-legend" class="lc-chart-legend"></div>
                                </div>
                            </div>
                    </div>
                    <div id="lc-schedule-modal" class="lc-modal-container">
                            <div class="lc-modal-content">
                                <button id="lc-modal-close-btn" class="lc-modal-close-btn" title="Đóng">×</button>
                                <h3>Lịch trả nợ chi tiết</h3>
                                <div id="lc-schedule-table-container" class="table-scroll-wrapper">
                                    </div>
                            </div>
                        </div>

                    <div class="amenities-nearby-pro">
                    <h2>Tiện ích lân cận</h2>
                    <div class="amenities-grid-pro">
                        <div class="amenity-card-pro">
                <div class="amenity-header-pro">
                        <div class="amenity-icon-pro" style="background-color: #e0f2f1; color: #00796b;">
                            <svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M11 9h2V6h3V4h-3V1h-2v3H8v2h3v3zm-4 9c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2zm-8.9-5h7.45c.75 0 1.41-.41 1.75-1.03l3.86-7.01L19.42 4l-3.87 7H8.53L4.27 2H1v2h2l3.6 7.59-1.35 2.44C4.52 15.37 5.24 17 6.5 17h12v-2H6.5c-.25 0-.42-.23-.35-.45l.13-.28L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.37-.67.04-1.52-.75-1.52H5.21l-.94-2H1v2h2l3.6 7.59L6.65 16h12.85l-2.95-5.34z"/></svg>
                        </div>
                        <h4>Mua sắm & Giải trí</h4>
                </div>
                    <div class="amenity-content">
                        <div class="amenity-details-pro">
                            <div class="amenity-item-pro">
                                <span class="name">Phố đi bộ Bùi Viện</span>
                                <span class="distance">~500 m</span>
                            </div>
                            <div class="amenity-item-pro">
                                <span class="name">Nowzone Fashion Mall</span>
                                <span class="distance">~1 km</span>
                            </div>
                            <div class="amenity-item-pro">
                                <span class="name">Chợ Bến Thành</span>
                                <span class="distance">~1.2 km</span>
                            </div>
                        </div>
                    </div>
            </div>

            <div class="amenity-card-pro">
                <div class="amenity-header-pro">
                    <div class="amenity-icon-pro" style="background-color: #e3f2fd; color: #1e88e5;">
                        <svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 3L1 9l11 6 9-4.91V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM12 13.5l-7-3.82v3.6l7 3.82 7-3.82v-3.6L12 13.5z"/></svg>
                    </div>
                    <h4>Giáo dục</h4>
                </div>
                <div class="amenity-content">
                    <div class="amenity-details-pro">
                        <div class="amenity-item-pro">
                            <span class="name">Trường TH Lương Thế Vinh</span>
                            <span class="distance">~400 m</span>
                        </div>
                        <div class="amenity-item-pro">
                            <span class="name">Đại học Văn Lang</span>
                            <span class="distance">~800 m</span>
                        </div>
                        <div class="amenity-item-pro">
                            <span class="name">Trường THCS Minh Đức</span>
                            <span class="distance">~1.5 km</span>
                        </div>
                        <div class="amenity-item-pro">
                            <span class="name">Trường THCS Minh Đức</span>
                            <span class="distance">~1.5 km</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="amenity-card-pro">
                <div class="amenity-header-pro">
                    <div class="amenity-icon-pro" style="background-color: #fce4ec; color: #d81b60;">
                        <svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>
                    </div>
                    <h4>Y tế</h4>
                </div>
                <div class="amenity-content">
                    <div class="amenity-details-pro">
                        <div class="amenity-item-pro">
                            <span class="name">Bệnh viện Răng Hàm Mặt</span>
                            <span class="distance">~1.3 km</span>
                        </div>
                        <div class="amenity-item-pro">
                            <span class="name">Bệnh viện Từ Dũ</span>
                            <span class="distance">~1.8 km</span>
                        </div>
                        <div class="amenity-item-pro">
                            <span class="name">Bệnh viện FV Sài Gòn</span>
                            <span class="distance">~2 km</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="amenity-card-pro">
                <div class="amenity-header-pro">
                    <div class="amenity-icon-pro" style="background-color: #f3e5f5; color: #8e24aa;">
                        <svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 2c-4.42 0-8 3.58-8 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm-2-8.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5S8.5 10.33 8.5 9.5 9.17 8 10 8zm4 0c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zm-2 5c-1.66 0-3-1.34-3-3h6c0 1.66-1.34 3-3 3z"/></svg>
                    </div>
                    <h4>Vui chơi & Giải trí</h4>
                </div>
                <div class="amenity-content">
                    
                    <div class="amenity-details-pro">
                        <div class="amenity-item-pro">
                            <span class="name">Công viên Ánh Sáng</span>
                            <span class="distance">3 phút</span>
                        </div>
                        <div class="amenity-item-pro">
                            <span class="name">Khu cắm trại</span>
                            <span class="distance">7 phút</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="amenity-card-pro">
                <div class="amenity-header-pro">
                    <div class="amenity-icon-pro" style="background-color: #e8f5e9; color: #388e3c;">
                        <svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/></svg>
                    </div>
                    <h4>Giao thông</h4>
                </div>
                <div class="amenity-content">
                    
                    <div class="amenity-details-pro">
                        <div class="amenity-item-pro">
                            <span class="name">Bến xe Miền Đông mới</span>
                            <span class="distance">15 phút</span>
                        </div>
                        <div class="amenity-item-pro">
                            <span class="name">Tuyến Metro số 1</span>
                            <span class="distance">10 phút</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="amenity-card-pro">
                <div class="amenity-header-pro">
                    <div class="amenity-icon-pro" style="background-color: #fff3e0; color: #fb8c00;">
                        <svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M4 10h3v7H4zM10.5 10h3v7h-3zM2 19h20v3H2zM17 10h3v7h-3zM12 1L2 6v2h20V6z"/></svg>
                    </div>
                    <h4>Ngân hàng</h4>
                </div>
                <div class="amenity-content">
                    <div class="amenity-details-pro">
                        <div class="amenity-item-pro">
                            <span class="name">Vietcombank</span>
                            <span class="distance">5 phút</span>
                        </div>
                        <div class="amenity-item-pro">
                            <span class="name">Techcombank</span>
                            <span class="distance">6 phút</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="amenity-card-pro">
                <div class="amenity-header-pro">
                    <div class="amenity-icon-pro" style="background-color: #eee; color: #757575;">
                        <svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>
                    </div>
                    <h4>Khác</h4>
                </div>
                <div class="amenity-content">
                    <div class="amenity-details-pro">
                        <div class="amenity-item-pro">
                            <span class="name">...</span>
                            <span class="distance">...</span>
                        </div>
                    </div>
                </div>
            </div>

                    </div>
                    </div>
                    <section class="price-history-section-detail" style="margin-top: 50px;">
                        <h2 id="detail-chart-dynamic-title">Biểu đồ biến động đơn giá</h2>
                        <div class="price-summary-cards">
                            <div class="summary-card">
                                <span class="card-label">Giá phổ biến (Tháng gần nhất)</span>
                                <span class="card-value" id="summary-card-current">--</span>
                            </div>
                            <div class="summary-card">
                                <span class="card-label">Trung bình 12 tháng</span>
                                <span class="card-value" id="summary-card-avg">--</span>
                            </div>
                            <div class="summary-card">
                                <span class="card-label">Biến động giá / 1 năm</span>
                                <span class="card-value" id="summary-card-yoy">--</span>
                            </div>
                        </div>
                        <div class="price-summary-cards" id="rental-summary-cards" style="display: none;">
                            <div class="summary-card">
                                <span class="card-label">Giá thuê trung bình</span>
                                <span class="card-value" id="summary-card-rent-avg">--</span>
                            </div>
                            <div class="summary-card">
                                <span class="card-label">Khoảng giá phổ biến</span>
                                <span class="card-value" id="summary-card-rent-range">--</span>
                            </div>
                            <div class="summary-card">
                                <span class="card-label">So với trung bình</span>
                                <span class="card-value" id="summary-card-rent-comparison">--</span>
                            </div>
                        </div>
                        <div class="price-chart-container-detail">
                            <div class="chart-header-detail">
                                <div class="chart-filters-detail">
                                    <div class="chart-filter-group-detail">
                                        <label>Năm:</label>
                                        <div class="year-filter-buttons" id="detail-chart-year-filters">
                                            </div>
                                    </div>
                                </div>
                            </div>
                            <div class="chart-wrapper-detail">
                                <canvas id="product-price-history-chart"></canvas>
                            </div>
                        </div>
                        <p class="chart-disclaimer">
                            Lưu ý: Phân tích này dựa trên dữ liệu của website BDSTot.net. Các yếu tố khác như vị trí cụ thể, tầng, hướng, tình trạng nội thất chi tiết, pháp lý riêng của từng căn có thể ảnh hưởng đến giá trị thực tế và sự hấp dẫn của sản phẩm.
                        </p>
                        
                    </section>
                    <section id="nearby-comparison-container" class="nearby-comparison-section" style="display: none;">
                        <h2 id="nearby-comparison-title">So sánh giá cùng khu vực</h2>
                        <div id="comparison-grid" class="comparison-grid">
                            </div>
                    </section>
                    <div class="map-container">
                        <h2>Vị trí trên bản đồ</h2>
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3918.610086333246!2d106.807308!3d10.841127!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31752110c03672d3%3A0x8a3359d2e5469a53!2sVinhomes%20Grand%20Park!5e0!3m2!1svi!2s!4v1670000000000!5m2!1svi!2s" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                    <section class="similar-listings-section">
                        <h2>Tin tương tự</h2>
                        <div class="similar-listings-scroller">
                            <div class="similar-listings-grid">
                                </div>
                        </div>
                    </section>
                    

                </div>

                <aside class="contact-sidebar">
                    <div class="broker-card">
                        <img src="assets/images/nhamoigioi.jpg" alt="Avatar môi giới" class="broker-avatar">
                        <h4 class="broker-name">Trần Thị Bích</h4>
                        <p class="broker-role">Chuyên viên tư vấn</p>

                        <div class="broker-actions">
                            <button id="sidebar-contact-btn" class="btn-call">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"></path></svg>
                                Gọi ngay
                            </button>
                            <a href="https://zalo.me/0909123456" target="_blank" class="btn-zalo">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 50 50" fill="none"></svg>
                                Chat Zalo
                            </a>                        
                        </div>

                        <form id="inline-contact-form" class="inline-contact-form">
                            <p class="form-title">Để lại thông tin tư vấn</p>
                            <input type="text" name="name" placeholder="Họ và tên" required>
                            <input type="tel" name="phone" placeholder="Số điện thoại" required>
                            <textarea name="message" rows="3" placeholder="Nhu cầu của bạn..."></textarea>
                            <button type="submit" class="btn-primary">Gửi thông tin</button>
                        </form>
                    </div>
                    </aside>
                
            </div>
        </div>
    </main>
    
    <div class="mobile-cta-bar">
        <a href="https://zalo.me/0909123456" target="_blank" class="btn-zalo">Chat Zalo</a>
        <a href="tel:0909123456" class="btn-call">Gọi ngay</a>
    </div>
    <div id="contact-modal" class="modal-container">
            <div class="modal-content">
                <button id="modal-close-btn" class="modal-close-btn" title="Đóng">×</button>
                <h3>Để lại thông tin</h3>
                <p>Chuyên gia của chúng tôi sẽ liên hệ tư vấn miễn phí cho bạn trong thời gian sớm nhất.</p>
                
                <a href="tel:0909123456" class="modal-phone-link">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 16.5V20C21 20.5523 20.5523 21 20 21C10.6112 21 3 13.3888 3 4C3 3.44772 3.44772 3 4 3H7.5C7.76522 3 8.01957 3.10536 8.20711 3.29289L10.7071 5.79289C11.0976 6.18342 11.0976 6.81658 10.7071 7.20711L9.12132 8.79289C10.3484 11.1403 12.8597 13.6516 15.2071 14.8787L16.7929 13.2929C17.1834 12.9024 17.8166 12.9024 18.2071 13.2929L20.7071 15.7929C20.8946 15.9804 21 16.2348 21 16.5Z" fill="#FFFFFF"/>
                        </svg>

                    <span>Gọi ngay: 0909 123 456</span>
                </a>

                <div class="modal-separator"><span>Hoặc điền form bên dưới</span></div>
                
                <form class="contact-form">
                    <input type="text" name="name" placeholder="Họ và tên của bạn" required>
                    <input type="tel" name="phone" placeholder="Số điện thoại" required>
                    <textarea name="message" rows="3" placeholder="Nhu cầu của bạn..."></textarea>
                    <button type="submit" class="btn-primary">Gửi thông tin</button>
                </form>
            </div>
        </div>
    
    <div id="feng-shui-modal" class="modal-container">
    <div class="modal-content">
        <button class="modal-close-btn" title="Đóng">×</button>
        
        <div id="feng-shui-input-wrapper">
            <h3>Xem Phong Thủy Theo Tuổi</h3>
            <p>Nhập năm sinh và giới tính của bạn để xem hướng và màu sắc hợp mệnh.</p>
            <div class="modal-separator"></div>
            <form id="feng-shui-form" class="contact-form">
                <input type="text" inputmode="numeric" pattern="[0-9]*" name="birth_year" placeholder="Nhập năm sinh (VD: 1990)" required>
                <select name="gender" required>
                    <option value="" disabled selected>Chọn giới tính</option>
                    <option value="Nam">Nam</option>
                    <option value="Nữ">Nữ</option>
                </select>
                <div id="feng-shui-error" style="color: red; font-size: 14px; margin-top: -5px; margin-bottom: 10px; text-align: left; display: none;"></div>
                <button type="submit" class="btn-primary">Xem kết quả</button>
            </form>
        </div>

        <div id="feng-shui-result-wrapper" style="display: none;">
            <h3 id="feng-shui-result-title"></h3>
            <div class="modal-separator"></div>
            <div id="feng-shui-result-content" class="feng-shui-result-grid">
                <div id="feng-shui-info-col"></div>
                <div id="feng-shui-image-col"></div>
            </div>
            <div id="feng-shui-huong-results" style="margin-top: 20px;">
    <div class="analysis-item good">
        <div class="analysis-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#4CAF50"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path></svg>
        </div>
        <div class="analysis-content">
            <h5>Sinh Khí (Tốt)</h5>
            <p>Thu hút tài lộc, danh vọng, thăng quan phát tài.</p>
        </div>
    </div>
    <div class="analysis-item bad">
        <div class="analysis-icon">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#f44336"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"></path></svg>
        </div>
        <div class="analysis-content">
            <h5>Tuyệt Mệnh (Xấu)</h5>
            <p>Phá sản, bệnh tật chết người.</p>
        </div>
    </div>
</div>
            <p class="modal-disclaimer">
                <strong>Lưu ý quan trọng:</strong> Các kết quả và thông tin được cung cấp bởi tiện ích này chỉ mang tính chất tham khảo và giải trí. Chúng tôi không đảm bảo tính chính xác tuyệt đối và không chịu bất kỳ trách nhiệm nào về các quyết định, hành động, hoặc tổn thất của người dùng dựa trên những thông tin này.
            </p>
            <button id="feng-shui-back-btn" class="btn-secondary-custom" style="margin-top: 20px;">Tra cứu lại</button>
        </div>
    </div>
</div>

        <div id="favorites-drawer-container">
        <div class="favorites-drawer-overlay"></div>
        <div class="favorites-drawer">
            <div class="drawer-header">
                <h3>Danh sách yêu thích</h3>
                <button class="drawer-close-btn" title="Đóng">×</button>
            </div>
            <div class="drawer-content">
                </div>
           
        </div>
    </div>
    <footer class="footer-wrapper">
        <div class="header-footer-limiter">
            <div class="site-footer">
                <div class="footer-widget footer-col-1">
                     <a href="index.html">
                        <img src="assets/images/logo-footer.png" alt="Logo Footer" class="footer-logo">
                    </a>
                    <p><b>BDSTot.net - Bất Động Sản Tốt</b></p>
               		<p>Số điện thoại: <a href="tel:0123456789">0123 456 789</a></p>
                    <p>Mail: <a href="mailto:contact@bdstot.net">contact@bdstot.net</a></p>
                    
                </div>

                <div class="footer-widget">
                    <h4 class="widget-title accordion-toggle">VỀ CHÚNG TÔI</h4>
                    <ul class="widget-links">
                        <li><a href="gioi-thieu.html">Giới thiệu</a></li>
                        <li><a href="doi-ngu.html">Đội ngũ</a></li>
                        <li><a href="lien-he.html">Liên hệ</a></li>
                    </ul>
                </div>

                <div class="footer-widget">
                    <h4 class="widget-title accordion-toggle">ĐIỀU KHOẢN</h4>
                    <ul class="widget-links">
                        <li><a href="chinh-sach-bao-mat.html">Chính sách bảo mật</a></li>
                        <li><a href="dieu-khoan-su-dung.html">Điều khoản sử dụng</a></li>
                    </ul>
                </div>

                <div class="footer-widget footer-col-4">
                    <h4 class="widget-title">KẾT NỐI VỚI CHÚNG TÔI</h4>

                    <div class="footer-socials">
                        <a href="#" class="social-icon" aria-label="Facebook">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                <path d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m13 2h-2.5a3.5 3.5 0 0 0-3.5 3.5V11h-2v3h2v7h3v-7h3v-3h-3V8.5A.5.5 0 0 1 15 8h3V5z"/>
                            </svg>
                        </a>
                        <a href="#" class="social-icon" aria-label="YouTube">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24">
                                <path d="M10 15l5.19-3L10 9v6m11.56-7.83c.13.47.22 1.1.28 1.9.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83-.25.9-.83 1.48-1.73 1.73-.47.13-1.33.22-2.65.28-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44-.9-.25-1.48-.83-1.73-1.73-.13-.47-.22-1.1-.28-1.9-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83.25-.9.83-1.48 1.73-1.73.47-.13 1.33.22 2.65.28 1.3.07 2.49.1 3.59.1L12 5c4.19 0 6.8.16 7.83.44.9.25 1.48.83 1.73 1.73z"/>
                            </svg>
                        </a>
                        <a href="#" class="social-icon" aria-label="LinkedIn">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24" fill="white">
                                <path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4s1.39.63 1.39 1.4v4.93h2.8zM6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69s-1.68.76-1.68 1.69c0 .92.75 1.68 1.68 1.68zm-1.39 1.3h2.79v8.37H5.5V9.86z"/>
                            </svg>
                        </a>
                    </div>

                    <a href="#" target="_blank" rel="noopener noreferrer" style="margin-top: 20px; display: inline-block;">
                        <img src="assets/images/bo-cong-thuong.png" alt="Logo Bộ Công Thương" class="bct-logo">
                    </a>
                </div>
            </div>
             <div class="copyright-text">
                <p>Copyright 2025 - Bản quyền của BĐS Tốt</p>
            </div>
        </div>
    </footer>
    
    <script src="assets/js/template.js"></script>
    <script type="module" src="assets/js/data-menu.js"></script>

     <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/price-data.js"></script>
    <script src="assets/js/product-details-data.js"></script>
    <script src="assets/js/product-details-data-thue.js"></script>
    <script src="assets/js/product-detail.js"></script>
    <script src="assets/js/phong_thuy_data.js"></script> 
    <script src="assets/js/listing.js"></script> 
    <script src="assets/js/nearby-data.js"></script> 
    <script src="assets/js/price-data-thue.js"></script> 
    <script type="module">
    // =====================================================================
    // == SCRIPT TỔNG HỢP CUỐI CÙNG (DESKTOP & MOBILE & STICKY HEADER) ==
    // =====================================================================

    document.addEventListener('DOMContentLoaded', () => {

        // --- PHẦN 1: DỮ LIỆU & BIẾN TOÀN CỤC ---
        const initialMenuData = {
           "Dự án": [ { "Loại hình": "Chung cư", "Khu vực": ["TP. Hồ Chí Minh", "Bình Dương", "Đồng Nai"] }, { "Loại hình": "Khu đô thị", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội", "Long An"] } ],
           "Mua bán": [ { "Loại hình": "Căn hộ", "Khu vực": ["TP. Hồ Chí Minh", "Lâm Đồng", "Bà Rịa - Vũng Tàu"] }, { "Loại hình": "Shophouse", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội", "Đà Nẵng"] } ],
           "Cho thuê": [ { "Loại hình": "Căn hộ", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội"] }, { "Loại hình": "Shophouse", "Khu vực": ["TP. Hồ Chí Minh", "Hà Nội", "Vĩnh Long"] } ],
           "Wiki": [ { "Danh mục": "Pháp lý", "slug": "phap-ly" }, { "Danh mục": "Kinh nghiệm", "slug": "kinh-nghiem" }, { "Danh mục": "Phong thuỷ", "slug": "phong-thuy" } ],
           "Tin tức": [ { "Danh mục": "Dự án", "slug": "du-an" }, { "Danh mục": "Thị trường", "slug": "thi-truong" } ],
           "Doanh nghiệp": [ { "Danh mục": "Chủ đầu tư", "slug": "chu-dau-tu" }, { "Danh mục": "Nhà thầu thi công", "slug": "nha-thau-thi-cong" } ]
        };
        
        const featuredProjectsData = [
            {
                name: 'The Global City',
                description: 'Khu đô thị phức hợp chuẩn quốc tế tại TP. Thủ Đức.',
                image: 'assets/images/project-gallery-1.jpg',
                link: '#'
            }
        ];

        const header = document.querySelector('.header-wrapper');
        const mainMenuContainer = document.getElementById('main-nav');
        const mainMenuUl = document.getElementById('main-menu-list');
        const hamburgerButton = document.getElementById('hamburger-button');
        const menuOverlay = document.getElementById('menu-overlay');
        const megaMenuContainer = document.getElementById('cct-mega-menu');
        
        let activeMenuItem = null;
        let menuTimeout;

        // --- PHẦN 2: CÁC HÀM TIỆN ÍCH ---
        const toSlug = (str) => {
            if (!str) return '';
            let s = str.toLowerCase();
            if (s === 'hồ chí minh') return 'tp-ho-chi-minh';
            if (s === 'hà nội') return 'tp-ha-noi';
            if (s === 'đà nẵng') return 'tp-da-nang';
            if (s === 'cần thơ') return 'tp-can-tho';
            if (s === 'hải phòng') return 'tp-hai-phong';
            s = s.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            s = s.replace(/[đĐ]/g, 'd');
            s = s.replace(/([^0-9a-z-\s])/g, '');
            s = s.replace(/(\s+)/g, '-');
            s = s.replace(/-+/g, '-');
            s = s.replace(/^-+|-+$/g, '');
            return s;
        };
        
        function getLink(menuKey, catKey, subItem) {
            let baseUrl = '';
            let params = [];
            const lowerMenuKey = menuKey.toLowerCase();
            const categorySlug = toSlug(catKey);
            if (lowerMenuKey.includes('dự án'))
            baseUrl = 'list-du-an.html';
            else if (lowerMenuKey.includes('bán')) baseUrl = 'listing-ban.html';
            else if (lowerMenuKey.includes('thuê')) baseUrl = 'listing-thue.html';
            else if (lowerMenuKey.includes('wiki')) baseUrl = 'wiki.html';
            else if (lowerMenuKey.includes('tin tức')) baseUrl = 'news.html';
            else if (lowerMenuKey.includes('doanh nghiệp')) baseUrl = 'business.html';
            else baseUrl = 'listing.html';
            if (catKey) {
                let paramKey = ['Dự án', 'Mua bán', 'Cho thuê'].includes(menuKey) ? 'loaihinh' : 'danh-muc';
                params.push(`${paramKey}=${categorySlug}`);
            }
            if (subItem) {
                params.push(`thanhpho=${toSlug(subItem)}`);
            }
            return `${baseUrl}${params.length > 0 ? '?' : ''}${params.join('&')}`;
        }

        function debounce(func, delay = 250) {
            let timeout;
            return (...args) => { clearTimeout(timeout); timeout = setTimeout(() => func.apply(this, args), delay); };
        }

        // --- PHẦN 3: LOGIC MENU ---

        function initMenu() {
            if (window.innerWidth > 1024) {
                handleDesktopMenu();
            } else {
                handleMobileMenu();
            }
        }
        
        function handleDesktopMenu() {
            const nav = document.getElementById('main-nav');
            const mainMenu = document.getElementById('main-menu-list');
            if (!nav || !mainMenu || !megaMenuContainer) return;
            mainMenu.innerHTML = ''; 
            for (const menuKey in initialMenuData) {
                const li = document.createElement('li');
                li.className = 'has-dropdown';
                const a = document.createElement('a');
                a.href = '#'; 
                a.textContent = menuKey;
                li.appendChild(a);
                mainMenu.appendChild(li);
                a.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (activeMenuItem === e.target.parentElement) {
                        closeDesktopPanel();
                    } else {
                        if (activeMenuItem) activeMenuItem.classList.remove('active');
                        activeMenuItem = e.target.parentElement;
                        activeMenuItem.classList.add('active');
                        populateDesktopPanel(menuKey);
                        setTimeout(() => megaMenuContainer.classList.add('is-open'), 10);
                    }
                });
            }
            megaMenuContainer.querySelector('.menu-panel-overlay')?.addEventListener('click', closeDesktopPanel);
            nav.addEventListener('mouseleave', () => { menuTimeout = setTimeout(closeDesktopPanel, 300); });
            nav.addEventListener('mouseenter', () => clearTimeout(menuTimeout));
            megaMenuContainer.addEventListener('mouseenter', () => clearTimeout(menuTimeout));
            megaMenuContainer.addEventListener('mouseleave', () => { menuTimeout = setTimeout(closeDesktopPanel, 300); });
        }

        // =======================================================
        // == HÀM ĐÃ ĐƯỢC CẬP NHẬT ĐẦY ĐỦ LOGIC MỚI NHẤT ==
        // =======================================================
        function populateDesktopPanel(menuKey) {
            const menuItems = initialMenuData[menuKey];
            const col1Header = document.querySelector('#cct-mega-menu .menu-panel-col.col-1 h4'); // --- ĐÃ THÊM ---
            const col1List = document.getElementById('mega-menu-col-1-list');
            const col2List = document.getElementById('mega-menu-col-2-list');
            const col3Content = document.getElementById('mega-menu-col-3-content');

            if (!col1List || !col2List || !col3Content || !col1Header) return; // --- ĐÃ SỬA ---
            
            col1List.innerHTML = '';
            col2List.innerHTML = '';
            col3Content.innerHTML = '';

            if (!menuItems || menuItems.length === 0) {
                col1Header.textContent = '';
                return;
            }

            // --- ĐÃ THÊM: LOGIC TỰ ĐỘNG ĐẶT TIÊU ĐỀ ---
            const firstItem = menuItems[0];
            let col1Title = '';
            if (firstItem.hasOwnProperty('Loại hình')) {
                col1Title = 'Loại hình';
            } else if (firstItem.hasOwnProperty('Danh mục')) {
                col1Title = 'Danh mục';
            }
            col1Header.textContent = col1Title;
            // --- KẾT THÚC PHẦN THÊM MỚI ---

            const isMega = firstItem.hasOwnProperty('Khu vực');
            megaMenuContainer.querySelector('.menu-panel-columns').classList.toggle('is-single-col-data', !isMega);
            
            menuItems.forEach((item, index) => {
                const categoryName = item["Loại hình"] || item["Danh mục"];
                const li = document.createElement('li');
                li.dataset.category = categoryName;
                if (isMega) {
                    li.textContent = categoryName;
                } else {
                    const link = document.createElement('a');
                    link.href = getLink(menuKey, categoryName);
                    link.textContent = categoryName;
                    link.className = 'direct-link';
                    li.appendChild(link);
                }
                if (index === 0) li.classList.add('active');
                col1List.appendChild(li);
            });

            if (isMega) {
                updateDesktopSubMenu(menuItems[0]["Loại hình"], menuKey);
                col1List.addEventListener('mouseover', e => {
                    const targetLi = e.target.closest('li');
                    if (targetLi && targetLi.dataset.category) {
                        col1List.querySelectorAll('li').forEach(li => li.classList.remove('active'));
                        targetLi.classList.add('active');
                        updateDesktopSubMenu(targetLi.dataset.category, menuKey);
                    }
                });
            }
            
            featuredProjectsData.forEach(project => {
                const card = document.createElement('a');
                card.href = project.link;
                card.className = 'featured-project-card';
                card.innerHTML = `<img src="${project.image}" alt="${project.name}"><div class="featured-project-info"><h5>${project.name}</h5><p>${project.description}</p></div>`;
                col3Content.appendChild(card);
            });
        }
        
        function updateDesktopSubMenu(categoryKey, menuKey) {
            const subMenuContainer = document.getElementById('mega-menu-col-2-list');
            const menuItems = initialMenuData[menuKey];
            const targetItem = menuItems.find(item => item["Loại hình"] === categoryKey);
            const subItems = targetItem ? targetItem["Khu vực"] : [];
            subMenuContainer.innerHTML = subItems.map(item => `<li><a href="${getLink(menuKey, categoryKey, item)}">${item}</a></li>`).join('');
        }

        function closeDesktopPanel() {
            if (megaMenuContainer) megaMenuContainer.classList.remove('is-open');
            if (activeMenuItem) {
                activeMenuItem.classList.remove('active');
                activeMenuItem = null;
            }
        }

        function handleMobileMenu() {
            const nav = document.getElementById('main-nav');
            const overlay = document.getElementById('menu-overlay');
            const hamburger = document.getElementById('hamburger-button');
            if (!nav || !overlay || !hamburger) return;
            nav.innerHTML = '<div class="menu-slider"></div>';
            const slider = nav.querySelector('.menu-slider');
            const createPanel = (level, title, content) => {
                const panel = document.createElement('div');
                panel.className = 'menu-panel';
                panel.dataset.level = level;
                let headerHTML = `<h4 class="panel-title">${title}</h4>`;
                if (level > 0) {
                    headerHTML = `<a href="#" class="panel-back-button"><svg fill="currentColor" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg></a>` + headerHTML;
                } else {
                    headerHTML += `<button class="mobile-menu-close">&times;</button>`;
                }
                panel.innerHTML = `<div class="panel-header">${headerHTML}</div><ul class="panel-list">${content}</ul>`;
                return panel;
            };
            const openMenu = () => {
                if (!slider.querySelector('[data-level="0"]')) {
                    const level1Content = Object.keys(initialMenuData).map(key => `<li class="has-submenu" data-level="0" data-key="${key}"><a href="#">${key}</a></li>`).join('');
                    const panel1 = createPanel(0, 'Menu', level1Content);
                    slider.appendChild(panel1);
                    panel1.querySelector('.mobile-menu-close').addEventListener('click', closeMenu);
                }
                nav.classList.add('is-open');
                overlay.classList.add('is-visible');
                document.body.style.overflow = 'hidden';
            };
            const closeMenu = () => {
                nav.classList.remove('is-open');
                overlay.classList.remove('is-visible');
                document.body.style.overflow = '';
                setTimeout(() => {
                    slider.style.transform = 'translateX(0%)';
                    slider.querySelectorAll('.menu-panel').forEach(p => { if (p.dataset.level > 0) p.remove(); });
                }, 350);
            };
            hamburger.onclick = openMenu;
            overlay.onclick = closeMenu;
            slider.addEventListener('click', (e) => {
                const linkTarget = e.target.closest('a');
                if (linkTarget && linkTarget.getAttribute('href') !== '#') {
                    closeMenu();
                    return;
                }
                e.preventDefault();
                const target = e.target;
                const currentPanel = target.closest('.menu-panel');
                if (!currentPanel) return;
                if (target.closest('.panel-back-button')) {
                    const currentLevel = parseInt(currentPanel.dataset.level, 10);
                    slider.style.transform = `translateX(-${(currentLevel - 1) * 100}%)`;
                    setTimeout(() => currentPanel.remove(), 350);
                    return;
                }
                const targetLi = target.closest('li[data-key]');
                if (targetLi) {
                    if(e.target.closest('a')?.getAttribute('href') === '#') { e.preventDefault(); }
                    const level = parseInt(targetLi.dataset.level, 10);
                    const menuKey = targetLi.dataset.key;
                    const category = targetLi.dataset.category;
                    let nextLevelContent = '', nextLevelTitle = '';
                    if (level === 0) {
                        nextLevelTitle = menuKey;
                        const items = initialMenuData[menuKey];
                        nextLevelContent = items.map(item => {
                            const name = item["Loại hình"] || item["Danh mục"];
                            const hasSubmenu = item.hasOwnProperty('Khu vực');
                            const link = hasSubmenu ? '#' : getLink(menuKey, name, null);
                            return `<li class="${hasSubmenu ? 'has-submenu' : ''}" data-level="1" data-key="${menuKey}" data-category="${name}"><a href="${link}">${name}</a></li>`;
                        }).join('');
                    }
                    else if (level === 1) {
                        const parentItem = initialMenuData[menuKey].find(item => (item["Loại hình"] || item["Danh mục"]) === category);
                        if (!parentItem || !parentItem["Khu vực"]) return;
                        nextLevelTitle = category;
                        const khuVucItems = parentItem["Khu vực"];
                        nextLevelContent = khuVucItems.map(kv => `<li><a href="${getLink(menuKey, category, kv)}">${kv}</a></li>`).join('');
                    }
                    if (nextLevelContent) {
                        const newPanel = createPanel(level + 1, nextLevelTitle, nextLevelContent);
                        slider.appendChild(newPanel);
                        slider.style.transform = `translateX(-${(level+1) * 100}%)`;
                    }
                }
            });
        }
        
        // --- PHẦN 4: CÁC SỰ KIỆN TOÀN CỤC ---
        if (header) {
            let lastScrollTop = 0;
            const sidebar = document.querySelector('.listing-filter-sidebar, .contact-sidebar, .sidebar-column'); 
            window.addEventListener('scroll', () => {
                let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                if (scrollTop > lastScrollTop && scrollTop > header.offsetHeight) {
                    header.classList.add('header--hidden');
                    if (sidebar) sidebar.classList.add('sidebar--header-hidden');
                } else {
                    header.classList.remove('header--hidden');
                    if (sidebar) sidebar.classList.remove('sidebar--header-hidden');
                }
                lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
                if (megaMenuContainer && megaMenuContainer.classList.contains('is-open')) {
                    closeDesktopPanel();
                }
            });
        }

        document.addEventListener('click', (event) => {
            if (megaMenuContainer && mainMenuContainer && megaMenuContainer.classList.contains('is-open')) {
                if (!mainMenuContainer.contains(event.target) && !megaMenuContainer.contains(event.target)) {
                    closeDesktopPanel();
                }
            }
        });

        window.addEventListener('resize', debounce(initMenu, 250));
        
        // --- PHẦN 5: KHỞI CHẠY LẦN ĐẦU ---
        initMenu();
    });
    </script>
</body>
</html>